/*
 * This file was generated by the Gradle 'init' task.
 *
 * This generated file contains a sample Scala application project to get you started.
 * For more details on building Java & JVM projects, please refer to https://docs.gradle.org/8.3/userguide/building_java_projects.html in the Gradle documentation.
 */

plugins {
    // Plugin de Scala → permite compilar y trabajar con código Scala
    id 'scala'

    // Plugin para aplicaciones de línea de comando en Java/Scala
    id 'application'

    // Plugin de scalastyle para chequeo de estilo en Scala
    id("com.github.alisiikh.scalastyle") version "3.5.0"
}

// Configuración de memoria para compilación Scala y ejecución Java
tasks.withType(ScalaCompile) {
    scalaCompileOptions.additionalParameters = [
            "-J-Xmx2g",
    ]
}

tasks.withType(JavaExec) {
    jvmArgs = ["-Xmx2g"]
}

tasks.withType(ScalaCompile) {
    scalaCompileOptions.additionalParameters += ["-J-Xss8m","-J-Xmx2g"]
}

tasks.withType(JavaExec) {
    jvmArgs += ["-Xss8m","-Xmx2g"]
}

repositories {
    //Usamos Maven Central para todas las dependencias
    mavenCentral()
}

dependencies {
    //Librería base de Scala 2.13
    implementation 'org.scala-lang:scala-library:2.13.11'

    // Dependencias adicionales de tu proyecto
    implementation 'com.google.guava:guava:32.1.1-jre'
    implementation 'com.storm-enroute:scalameter-core_2.13:0.21'
    implementation group: 'org.scala-lang.modules', name: 'scala-parallel-collections_2.13', version: '1.0.4'

    //TESTING
    //ScalaTest puro
    testImplementation 'org.scalatest:scalatest_2.13:3.2.16'

    //Runtime necesario para algunas funcionalidades de ScalaTest
    testRuntimeOnly 'org.scala-lang.modules:scala-xml_2.13:1.2.0'

    // ⭐ ADAPTADOR para que ScalaTest funcione con JUnit Platform (ESTO FALTABA)
    testImplementation 'co.helmethair:scalatest-junit-runner:0.2.0'
}

java {
    //Aplicamos Java 17 como toolchain (compatibilidad)
    toolchain {
        languageVersion = JavaLanguageVersion.of(17)
    }
}

application {
    //Clase principal de la aplicación
    mainClass = 'taller.App'
}

//Configuración de Gradle para ejecutar ScalaTest correctamente
tasks.withType(Test) {
    useJUnitPlatform {
        includeEngines 'scalatest'
    }
    testLogging {
        events "passed", "skipped", "failed"
        exceptionFormat "full"
    }
}